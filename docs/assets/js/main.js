const searchInput=document.querySelector(".js-search"),btn=document.querySelector(".js-btn");let searchedShows=[];function getData(){const e=searchInput.value;fetch("//api.tvmaze.com/search/shows?q= + "+e).then(e=>e.json()).then((function(e){searchedShows=e,paintShows(),listenShows(),listenFavs()}))}btn.addEventListener("click",getData),getData();const showsContainer=document.querySelector(".js-shows-container"),wrapperEl=document.querySelector(".page-wrapper");function paintShows(){let e="";for(let t=0;t<searchedShows.length;t++){const s=searchedShows[t].show.name;if(e+=`<li class="shows-list__item js-show-item" data-id="${searchedShows[t].show.id}">`,null!=searchedShows[t].show.image){e+=`<img src="${searchedShows[t].show.image.original}" alt="Imagen de la serie ${s}" class="shows-list__img" title="Imagen de la serie ${s}"></img>`}else imgURL="./assets/images/nopicture.png",e+=`<img src="${imgURL}" alt="Imagen de la serie ${s}" class="shows-list__img">`;e+=`<h3 class="shows-list__title">${s}</h3>`,e+="</li>",wrapperEl.classList.add("hidden")}showsContainer.innerHTML=e}let favoritedShows=[],favoritedShowsId=[];function selectFavorites(e){const t=e.currentTarget,s=parseInt(t.dataset.id);let o={id:s,name:t.querySelector(".shows-list__title").innerHTML,image:t.querySelector(".shows-list__img").src};console.log({favoritedShows:favoritedShows}),favoritedShowsId=favoritedShows.map((function(e){return parseInt(e.id)}));const a=favoritedShowsId.indexOf(s);-1===a?(favoritedShows.push(o),t.classList.add("shows-list__item--favorite")):(favoritedShows.splice(a,1),t.classList.remove("shows-list__item--favorite")),paintFavorites(),listenFavs(),setLocalStorage()}function listenShows(){const e=document.querySelectorAll(".js-show-item");for(const t of e)t.addEventListener("click",selectFavorites)}const favsContainer=document.querySelector(".js-favs-container");function paintFavorites(){let e="";for(let t=0;t<favoritedShows.length;t++){const s=favoritedShows[t].name,o=favoritedShows[t].id,a=favoritedShows[t].image;e+='<li class="favorites-list__item">',null!=favoritedShows[t].image?e+=`<img src="${a}" alt="Imagen de la serie ${s}" class="favorites-list__img" title="Imagen de la serie ${s}"></img>`:(a="https://via.placeholder.com/210x295/ffffff/666666/?",htmlShows+=`<img src="${a}" alt="Imagen de la serie ${s}" class="favorites-list__img`),e+=`<h4 class="favorites-list__title">${s}</h4>`,e+=`<input type="button" value="x" class="favorites-list__remove-btn" data-id="${o}">`,e+="</li>"}favsContainer.innerHTML=e,setLocalStorage()}function setLocalStorage(){localStorage.setItem("favoritedShows",JSON.stringify(favoritedShows))}function getLocalStorage(){const e=localStorage.getItem("favoritedShows"),t=JSON.parse(e);null!==t?(favoritedShows=t,paintFavorites(),listenShows()):getData()}function removeFav(e){for(let t=0;t<favoritedShows.length;t++){const s=e.currentTarget;parseInt(s.dataset.id)===parseInt(favoritedShows[t].id)&&favoritedShows.splice([t],1)}paintFavorites(),paintShows(),listenFavs(),listenShows()}function listenFavs(){const e=document.querySelectorAll(".favorites-list__remove-btn");for(const t of e)t.addEventListener("click",removeFav)}getLocalStorage();const deleteBtnEl=document.querySelector(".js-delete-btn"),resetFavorites=()=>{favoritedShows=[],localStorage.removeItem("favoritedShows"),paintFavorites(),listenFavs()};deleteBtnEl.addEventListener("click",resetFavorites);